---
title: How To Customize Elasticsearch Index Template
description: Learn how to add customizations to the Elasticsearch Index Template.
---

import { Alert } from "@/components/Alert"

<Alert type="success" title="What you'll learn">

- how to customize Elasticsearch Index Template

</Alert>

<Alert type="danger">
  This article requires advanced knowledge of Elasticsearch.
</Alert>

## Overview

We do not store all the data into the Elasticsearch because there is no need for it (eg. Headless CMS Models and Groups).

By the default, we have a basic index template for each of our applications that use Elasticsearch:
* File Manager Files [template](https://github.com/webiny/webiny-js/blob/feat/api-elasticsearch/index-template-plugin/packages/api-file-manager-ddb-es/src/elasticsearch/templates/base.ts)
* Form Builder Forms and Submissions [template](https://github.com/webiny/webiny-js/blob/feat/api-elasticsearch/index-template-plugin/packages/api-form-builder-so-ddb-es/src/elasticsearch/templates/base.ts)
* Headless CMS Entries [template](https://github.com/webiny/webiny-js/blob/feat/api-elasticsearch/index-template-plugin/packages/api-headless-cms-ddb-es/src/elasticsearch/templates/base.ts)
* Page Builder Pages [template](https://github.com/webiny/webiny-js/blob/feat/api-elasticsearch/index-template-plugin/packages/api-page-builder-so-ddb-es/src/elasticsearch/templates/base.ts)

Each of those templates define how the Elasticsearch index for that particular application will look like when it is created.
<Alert type="warning">
  Elasticsearch index templates are inserted on the installation of each application.
</Alert>

## Available Template Plugins

### File Manager
For the File Manager Files we have the [FileElasticsearchIndexTemplatePlugin](https://github.com/webiny/webiny-js/blob/8b1410114a2b9dd7836ff221dd0367cdf3ce9b62/packages/api-file-manager-ddb-es/src/plugins/FileElasticsearchIndexTemplatePlugin.ts).

### Form Builder
For the Form Builder Forms and Submissions we have the [FormElasticsearchIndexTemplatePlugin](https://github.com/webiny/webiny-js/blob/8b1410114a2b9dd7836ff221dd0367cdf3ce9b62/packages/api-form-builder-so-ddb-es/src/plugins/FormElasticsearchIndexTemplatePlugin.ts).

### Headless CMS
For the Headless CMS Entries we have [CmsEntryElasticsearchIndexTemplatePlugin](https://github.com/webiny/webiny-js/blob/8b1410114a2b9dd7836ff221dd0367cdf3ce9b62/packages/api-headless-cms-ddb-es/src/plugins/CmsEntryElasticsearchIndexTemplatePlugin.ts).

### Page Builder
For the Page Builder Pages we have the [PageElasticsearchIndexTemplatePlugin](https://github.com/webiny/webiny-js/blob/8b1410114a2b9dd7836ff221dd0367cdf3ce9b62/packages/api-page-builder-so-ddb-es/src/plugins/definitions/PageElasticsearchIndexTemplatePlugin.ts).

## How To Create Your Own Template?

### Rules
There are few rules that you will need to follow if you want to successfully create the index template.
1. The `name` property must be __UNIQUE__, or it will override the existing template.
Let's say you name your custom Headless CMS index template `headless-cms-entries-index-default` - it will overwrite our default one, so be careful if you do not want to override existing templates.

2. If you want to apply your template (override mapping) of the default template, use the `order` value greater than the template you want to override.
You can have two templates with the same `order` value that will get applied on the index creation, but you cannot be sure which one will override which one at that point, so be careful about that.

3. Each of the template plugin `index_patterns` __MUST__ match contain one of given regex patterns:
   * `-file-manager$` for the `FileElasticsearchIndexTemplatePlugin`
   * `-form-builder$` for the `FormElasticsearchIndexTemplatePlugin`
   * `-headless-cms-` for the `CmsEntryElasticsearchIndexTemplatePlugin`
   * `-page-builder$` for the `PageElasticsearchIndexTemplatePlugin`

Notice that index name patterns for File Manager, Page Builder and Form Builder end with a `$`, which means that index pattern must end with what is defined.
Headless CMS index name contains a bit more data, so we just match the `-headless-cms-` anywhere in the index pattern.

4. We gave our templates different minimum and maximum `order` values:
 * File Manager - 0 - 99 (the default template value is 50)
 * Form Builder - 100 - 199(the default template value is 150)
 * Headless CMS - 200 - 299 (the default template value is 250)
 * Page Builder - 300 - 399 (the default template value is 350)

### How Are The Index Names Created?

#### Overview

Index names can contain dashes (-), underscores (_), numbers (0-9) and english letters (a-z).

Index name __MUST__ always be lowercase, and it cannot start with dash, underscore or a number.

You can set the `ELASTICSEARCH_SHARED_INDEXES` environment variable to `true` to create a single index for all tenants for each application (or for each model in case of the Headless CMS), but we do not encourage it.

You can also set the `ELASTIC_SEARCH_INDEX_PREFIX` environment variable to `true` to add a prefix to every index created.
Use case for this would be for when you have multiple environment on a single Elasticsearch instance. You can prefix each environment indexes with, for example, `dev`, `prod`, `staging`, `test`, etc...

#### File Manager

Index name for the File Manager Files is built out of the `tenant id` and `-file-manager` suffix.
If your tenant is a `root` tenant, the index will look like `root-file-manager`.

You can see how the index is created in [this](https://github.com/webiny/webiny-js/blob/b615a8a02acf222f6a90c740ebbd7aec5e767218/packages/api-file-manager-ddb-es/src/operations/configurations.ts) file.

#### Form Builder

Index name for the Form Builder Forms and Submissions is built out of the `tenant id` and `-form-builder` suffix.
If your tenant is a `root` tenant, the index will look like `root-form-builder`.

You can see how the index is created in [this](https://github.com/webiny/webiny-js/blob/3c595a1d7edd07a9763ba3959f954f88fbb3d462/packages/api-form-builder-so-ddb-es/src/configurations.ts) file.

#### Headless CMS

Index name for the Headless CMS Entries is built out of `tenant id`, `-headless-cms`, `locale code` and `model id`.
If your tenant is a `root` tenant, locale is `en-US` and model is `Articles`, the index will look like `root-headless-cms-en-us-articles`.

You can see how the index is created in [this](https://github.com/webiny/webiny-js/blob/3c595a1d7edd07a9763ba3959f954f88fbb3d462/packages/api-headless-cms-ddb-es/src/configurations.ts) file.

#### Page Builder

Index name for the Page Builder Pages is built out of the `tenant id` and `-page-builder` suffix.
If your tenant is a `root` tenant, the index will look like `root-page-builder`.

You can see how the index is created in [this](https://github.com/webiny/webiny-js/blob/3c595a1d7edd07a9763ba3959f954f88fbb3d462/packages/api-page-builder-so-ddb-es/src/operations/configurations.ts) file.



### Example

Headless CMS index template plugin `CmsEntryElasticsearchIndexTemplatePlugin` example:
```typescript
import { CmsEntryElasticsearchIndexTemplatePlugin } from "@webiny/api-headless-cms-ddb-es/plugins/CmsEntryElasticsearchIndexTemplatePlugin";
const plugin = new CmsEntryElasticsearchIndexTemplatePlugin({
    name: "headless-cms-entries-index-custom-example",
    // apply the index template after the default one.
    order: 251,
    body: {
        index_patterns: ["*-headless-cms-de-*"],
        mappings: {
            properties: {
                // we do not want to map a field with name "jsonFieldName"
                jsonFieldName: {
                    enabled: false
                }
            }
        }
    }
})
```


Page Builder index template plugin `PageElasticsearchIndexTemplatePlugin` example:
```typescript
import { PageElasticsearchIndexTemplatePlugin } from "@webiny/api-page-builder-so-ddb-es/plugins/definitions/PageElasticsearchIndexTemplatePlugin";
const plugin = new PageElasticsearchIndexTemplatePlugin({
    name: "page-builder-pages-index-custom-example",
    // apply the index template after the default one.
    order: 251,
    body: {
        index_patterns: ["*-headless-cms-*"],
        mappings: {
            properties: {
                // we do not want to map a field with name "jsonFieldName"
                jsonFieldName: {
                    enabled: false
                }
            }
        }
    }
})
```
